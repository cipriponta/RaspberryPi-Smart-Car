import numpy
import cv2
import enum

# Enums
class IMAGE_OUTPUT(enum.Enum):
    COLOR = 1
    GREYSCALE = 2
    BLURRED = 3
    THRESHOLDED = 4

# Main Loop Constants
LOOP_DELAY = 0.001

# Camera Constants
CAMERA_IMAGE_WIDTH = 320
CAMERA_IMAGE_HEIGHT = 240
CAMERA_RESOLUTION = (CAMERA_IMAGE_WIDTH, CAMERA_IMAGE_HEIGHT)
CAMERA_FRAMERATE = 120
CAMERA_SHUTTER_SPEED = 40000
CAMERA_ISO = 800
CAMERA_INIT_TIME = 0.1
CAMERA_ROTATION = 180

# Image Constants
IMAGE_FORMAT_BGR = "bgr"
IMAGE_OUTPUT_DIMENSION = (1080, 720)

IMAGE_GREYSCALE_MAX_VALUE = 255
IMAGE_THRESHOLD_BLOCK_SIZE = 31
IMAGE_THRESHOLD_SUBTRACTED_CONSTANT = 9
IMAGE_THRESHOLD_SIGMA_X = 0
IMAGE_THRESHOLD_BLUR_METHOD = cv2.GaussianBlur
IMAGE_THRESHOLD_TYPE = cv2.THRESH_BINARY_INV
IMAGE_THRESHOLD_ADAPTIVE_METHOD = cv2.ADAPTIVE_THRESH_GAUSSIAN_C

IMAGE_CONTOUR_RETRIEVAL_MODE = cv2.RETR_LIST
IMAGE_CONTOUR_APPROX_METHOD = cv2.CHAIN_APPROX_NONE

IMAGE_CONTOUR_COLOR = (0, 150, 0)
IMAGE_RECTANGLE_COLOR = (150, 0, 0)
IMAGE_LINES_COLOR = (0, 66, 255)
IMAGE_LINES_LEFT_LINE_COLOR = (50, 0, 255)
IMAGE_LINES_MIDDLE_LINE_COLOR = (100, 255, 255)
IMAGE_LINES_RIGHT_LINE_COLOR = (255, 194, 0)
IMAGE_LINES_THICKNESS = 1
IMAGE_LINES_MIN_LENGTH = 25

IMAGE_OUTPUT_FRAME = IMAGE_OUTPUT.COLOR
IMAGE_DISPLAY_CONTOURS = True
IMAGE_DISPLAY_BOUNDED_LINES = True
IMAGE_DISPLAY_ALL_LINES = True
IMAGE_DISPLAY_GUIDING_LINES = True

# Motor Pins
PIN_MOTOR_A_EN = 33             # Yellow Cable
PIN_MOTOR_A_IN1 = 31            # Brown Cable
PIN_MOTOR_A_IN2 = 29            # Orange Cable
PIN_MOTOR_B_EN = 32             # White Cable
PIN_MOTOR_B_IN1 = 40            # Purple Cable
PIN_MOTOR_B_IN2 = 38            # Green Cable

MOTOR_PWM_FREQ = 500
MOTOR_PWM_NORMAL_DUTY_CYCLE = 90

MOTOR_PID_LINE_SETPOINT = 0
MOTOR_PID_SAMPLE_TIME = 0.2
MOTOR_PID_KP = 1
MOTOR_PID_KI = 0.0005
MOTOR_PID_KD = 0

# Debug Server Constants
RPI_IP_ADDRESS = "192.168.0.194"
RPI_PORT = 9999
MAX_CONNECIONS = 1
SEGMENT_FORMAT = "L"
RECEIVED_SEGMENT_SIZE = 4 * 1024
CLOSE_SERVER_KEY = 'q'